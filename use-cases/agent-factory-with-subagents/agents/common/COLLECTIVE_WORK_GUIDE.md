# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç–µ –∞–≥–µ–Ω—Ç–æ–≤

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—é –º–µ–∂–¥—É Pydantic AI –∞–≥–µ–Ω—Ç–∞–º–∏ —á–µ—Ä–µ–∑:
- –†–∞–∑–±–∏–≤–∫—É –∑–∞–¥–∞—á –Ω–∞ –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏
- –û—Ç—á–µ—Ç–Ω–æ—Å—Ç—å –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ
- –†–µ—Ñ–ª–µ–∫—Å–∏—é –∏ —É–ª—É—á—à–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏
- –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —à–∞–≥–∏ (Git + Archon)

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ —Å –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏

```python
from agents.common.pydantic_ai_decorators import create_universal_pydantic_agent

# –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏
agent = create_universal_pydantic_agent(
    model=get_llm_model(),
    deps_type=YourDependencies,
    system_prompt="–¢–≤–æ—è —ç–∫—Å–ø–µ—Ä—Ç–∏–∑–∞...",
    agent_type="your_agent_type",
    knowledge_tags=["your-agent", "domain"],
    with_collective_tools=True,  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
    with_knowledge_tool=True
)
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤ –∞–≥–µ–Ω—Ç–µ

–ê–≥–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç —Å–ª–µ–¥—É—é—â–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:

#### `break_down_to_microtasks` - –†–∞–∑–±–∏–≤–∫–∞ –Ω–∞ –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏

```python
# –í—ã–∑–æ–≤ –∞–≥–µ–Ω—Ç–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç:
üìã **–ú–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**
1. –ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏
2. –ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
3. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
4. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Å—Ç–∏
5. –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
6. –£–ª—É—á—à–µ–Ω–∏–µ –∏ —Ñ–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è

‚úÖ –ë—É–¥—É –æ—Ç—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –∫–∞–∂–¥–æ–π –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏
```

#### `report_microtask_progress` - –û—Ç—á–µ—Ç –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ

```python
# –ê–≥–µ–Ω—Ç —Å–æ–æ–±—â–∞–µ—Ç –æ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ –∫–∞–∂–¥–æ–π –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏
‚úÖ **–ú–∏–∫—Ä–æ–∑–∞–¥–∞—á–∞ 1** (completed): –ê–Ω–∞–ª–∏–∑ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–¥–∞—á–∏
   –î–µ—Ç–∞–ª–∏: –ó–∞–¥–∞—á–∞ —Å—Ä–µ–¥–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏, —Ç—Ä–µ–±—É–µ—Ç 4 —ç—Ç–∞–ø–∞
```

#### `reflect_and_improve` - –†–µ—Ñ–ª–µ–∫—Å–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏–µ

```python
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤ –∫–æ–Ω—Ü–µ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏
üîç **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã:**

**–ù–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
1. [–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ 1]
2. [–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ 2]

**–í–Ω–µ—Å–µ–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:**
- [–£–ª—É—á—à–µ–Ω–∏–µ 1]
- [–£–ª—É—á—à–µ–Ω–∏–µ 2]

‚úÖ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ—Å—Ç—å (0% –ø—Ä–æ–µ–∫—Ç-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–≥–æ –∫–æ–¥–∞)
‚úÖ –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å (—Ñ–∞–π–ª—ã –¥–æ 500 —Å—Ç—Ä–æ–∫)
```

#### `check_delegation_need` - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```python
# –ê–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω—É–∂–Ω–æ –ª–∏ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å
ü§ù **–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- Security Audit Agent - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- UI/UX Enhancement Agent - –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º
```

#### `delegate_task_to_agent` - –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏

```python
# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –∞–≥–µ–Ω—Ç–∞
‚úÖ –ó–∞–¥–∞—á–∞ —É—Å–ø–µ—à–Ω–æ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∞ –∞–≥–µ–Ω—Ç—É security_audit:
- Assignee: Security Audit Agent
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: high
- –°—Ç–∞—Ç—É—Å: —Å–æ–∑–¥–∞–Ω–∞ –≤ Archon
```

## –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ä–∞–±–æ—á–∏–π –ø—Ä–æ—Ü–µ—Å—Å –∞–≥–µ–Ω—Ç–∞

### –®–∞–≥ 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏ —Ä–∞–∑–±–∏–≤–∫–∞ –∑–∞–¥–∞—á–∏

```python
async def run_agent_task(user_message: str, deps: Dependencies) -> str:
    # –ê–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
    # break_down_to_microtasks() –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è LLM –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

    # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø–ª–∞–Ω —Ä–∞–±–æ—Ç—ã
    result = await agent.run(user_message, deps=deps)
    return result.data
```

### –®–∞–≥ 2: –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å—é

```python
# –ê–≥–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç report_microtask_progress()
# –¥–ª—è –∫–∞–∂–¥–æ–π –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏

# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å:
‚úÖ –ú–∏–∫—Ä–æ–∑–∞–¥–∞—á–∞ 1 –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ - –ê–Ω–∞–ª–∏–∑ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π
‚è≥ –ú–∏–∫—Ä–æ–∑–∞–¥–∞—á–∞ 2 –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ - –ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ –∑–Ω–∞–Ω–∏–π
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```python
# –ê–≥–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç check_delegation_need() –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
# –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –∑–∞–¥–∞—á–∏ –¥–ª—è –¥—Ä—É–≥–∏—Ö –∞–≥–µ–Ω—Ç–æ–≤ - –¥–µ–ª–µ–≥–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑
# delegate_task_to_agent()
```

### –®–∞–≥ 4: –†–µ—Ñ–ª–µ–∫—Å–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏–µ

```python
# –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–µ—Ä–µ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º
# –ê–≥–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç reflect_and_improve()

# –ù–∞—Ö–æ–¥–∏—Ç –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∏ —É–ª—É—á—à–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

### –®–∞–≥ 5: –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —à–∞–≥–∏

```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ run_with_integrations():
# 1. Git –∫–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è
# 2. –°—Ç–∞—Ç—É—Å –≤ Archon –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
# 3. –û—Ç—á–µ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä—ã

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–± (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```python
from agents.common.pydantic_ai_integrations import run_with_integrations

async def run_your_agent(user_message: str, api_key: str) -> str:
    deps = YourDependencies(api_key=api_key)

    # –í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    result = await run_with_integrations(
        agent=your_agent,
        user_message=user_message,
        deps=deps,
        agent_type="your_agent_type"
    )

    return result  # –£–∂–µ —Å—Ç—Ä–æ–∫–∞, –Ω–µ result.data
```

### –†—É—á–Ω–æ–π —Å–ø–æ—Å–æ–± (–¥–ª—è –æ—Å–æ–±—ã—Ö —Å–ª—É—á–∞–µ–≤)

```python
from agents.common.collective_work_tools import (
    break_down_to_microtasks,
    report_microtask_progress,
    reflect_and_improve
)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –≤—Ä—É—á–Ω—É—é –≤ –∫–æ–¥–µ –∞–≥–µ–Ω—Ç–∞
# (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–±)
```

## –ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π –∞–≥–µ–Ω—Ç–æ–≤

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–∞–∫–∏–µ –∞–≥–µ–Ω—Ç—ã –ª—É—á—à–µ –ø–æ–¥—Ö–æ–¥—è—Ç –¥–ª—è –∑–∞–¥–∞—á:

| –ê–≥–µ–Ω—Ç | –ö–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏ |
|-------|-------------|
| Security Audit | –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, —É—è–∑–≤–∏–º–æ—Å—Ç–∏, compliance, –∞—É–¥–∏—Ç |
| UI/UX Enhancement | –¥–∏–∑–∞–π–Ω, –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å, accessibility, UX |
| Performance Optimization | –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –ø—Ä–æ—Ñ–∏–ª–∏—Ä–æ–≤–∞–Ω–∏–µ |
| RAG Agent | –ø–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ |
| TypeScript Architecture | —Ç–∏–ø–∏–∑–∞—Ü–∏—è, –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ |
| Prisma Database | –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, SQL, —Å—Ö–µ–º—ã, –º–∏–≥—Ä–∞—Ü–∏–∏ |
| PWA Mobile | PWA, –º–æ–±–∏–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, offline |

## –ü—Ä–∏–º–µ—Ä –ø–æ–ª–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ —Ä–∞–±–æ—Ç—ã

```python
from agents.common.pydantic_ai_decorators import create_universal_pydantic_agent
from agents.common.pydantic_ai_integrations import run_with_integrations

# 1. –°–æ–∑–¥–∞–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞
agent = create_universal_pydantic_agent(
    model=get_llm_model(),
    deps_type=Dependencies,
    system_prompt="...",
    agent_type="example_agent",
    with_collective_tools=True  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
)

# 2. –ó–∞–ø—É—Å–∫ —Å –ø–æ–ª–Ω—ã–º–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è–º–∏
async def run_example_task(user_message: str) -> str:
    deps = Dependencies(api_key="...")

    result = await run_with_integrations(
        agent=agent,
        user_message=user_message,
        deps=deps,
        agent_type="example_agent"
    )

    return result

# –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# 1. –†–∞–∑–±–∏–≤–∫–∞ –Ω–∞ –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é)
# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (—Å–æ–∑–¥–∞—é—Ç—Å—è –∑–∞–¥–∞—á–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
# 3. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å—é –æ –∫–∞–∂–¥–æ–π –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–µ
# 4. –†–µ—Ñ–ª–µ–∫—Å–∏—è –∏ —É–ª—É—á—à–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
# 5. Git –∫–æ–º–º–∏—Ç —Å –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏
# 6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –≤ Archon
```

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

### –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

```python
from agents.common.pydantic_ai_integrations import pydantic_ai_integration

# –û—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫ PM
pydantic_ai_integration.enabled_integrations["pm_switch"] = False

# –û—Ç–∫–ª—é—á–∏—Ç—å Git –∫–æ–º–º–∏—Ç—ã
pydantic_ai_integration.enabled_integrations["git_commits"] = False

# –î–æ—Å—Ç—É–ø–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:
# - "pm_switch": –∞–≤—Ç–æ–ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –∫ Project Manager
# - "competency_check": –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–π –∏ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
# - "microtask_planning": –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–∫—Ä–æ–∑–∞–¥–∞—á
# - "git_commits": –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ Git –∫–æ–º–º–∏—Ç—ã
# - "russian_localization": —Ä—É—Å—Å–∫–∞—è –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è
```

## –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —à–∞–≥–∏

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–± (—á–µ—Ä–µ–∑ run_with_integrations)

```python
# –í—Å–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —à–∞–≥–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
# - Git –∫–æ–º–º–∏—Ç
# - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Archon
# - –û—Ç—á–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

result = await run_with_integrations(
    agent=agent,
    user_message=message,
    deps=deps,
    agent_type="your_agent"
)
# –§–∏–Ω–∞–ª—å–Ω—ã–µ —à–∞–≥–∏ —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### –†—É—á–Ω–æ–π —Å–ø–æ—Å–æ–± (–µ—Å–ª–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ run_with_integrations)

```python
from agents.common.pydantic_ai_integrations import execute_mandatory_final_steps

# –í –∫–æ–Ω—Ü–µ –∫–∞–∂–¥–æ–π –∑–∞–¥–∞—á–∏
final_result = await execute_mandatory_final_steps(
    task_description="–û–ø–∏—Å–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏",
    agent_type="your_agent_type",
    task_id="archon_task_id",  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
    task_status="done",
    notes="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏"
)

print(final_result)  # –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏

–ó–∞–¥–∞—á–∞ –º–æ–∂–µ—Ç –±—ã—Ç—å –æ—Ç–º–µ—á–µ–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è –¢–û–õ–¨–ö–û –µ—Å–ª–∏:

- ‚úÖ –ú–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏ –±—ã–ª–∏ –≤—ã–≤–µ–¥–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤ –Ω–∞—á–∞–ª–µ
- ‚úÖ –ü—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥–æ–π –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏ –±—ã–ª –æ—Ç–æ–±—Ä–∞–∂–µ–Ω
- ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –ø–æ–ª–Ω–∞—è —Ä–µ—Ñ–ª–µ–∫—Å–∏—è —Å –≤—ã—è–≤–ª–µ–Ω–∏–µ–º –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–æ–≤
- ‚úÖ –ù–∞–π–¥–µ–Ω–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –±—ã–ª–∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤—Å–µ–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º –∫–∞—á–µ—Å—Ç–≤–∞
- ‚úÖ –†–µ—Ñ–ª–µ–∫—Å–∏—è –ø–æ–∫–∞–∑–∞–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- ‚úÖ **Git –∫–æ–º–º–∏—Ç —Å–æ–∑–¥–∞–Ω**
- ‚úÖ **–°—Ç–∞—Ç—É—Å –≤ Archon –æ–±–Ω–æ–≤–ª–µ–Ω**

## –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### 1. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ create_universal_pydantic_agent

```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
agent = create_universal_pydantic_agent(
    with_collective_tools=True  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
)

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
agent = Agent(...)  # –ù—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –¥–æ–±–∞–≤–ª—è—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
```

### 2. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ run_with_integrations

```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
result = await run_with_integrations(agent, message, deps, agent_type)

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
result = await agent.run(message, deps=deps)  # –ù–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π
```

### 3. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ agent_type —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
agent_type="security_audit_agent"  # –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç AGENT_COMPETENCIES

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
agent_type="security"  # –ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç—Å—è —Å–∏—Å—Ç–µ–º–æ–π –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
```

### 4. –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —à–∞–≥–∏

```python
# ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ
final_report = await execute_mandatory_final_steps(...)
print(final_report)  # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

# ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
await execute_mandatory_final_steps(...)  # –ù–µ –ø–æ–∫–∞–∑–∞–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –Ω–µ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `create_universal_pydantic_agent` –≤–º–µ—Å—Ç–æ `Agent()`

```python
# –í–º–µ—Å—Ç–æ:
agent = Agent(model, deps_type, system_prompt)

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ:
agent = create_universal_pydantic_agent(
    model, deps_type, system_prompt,
    with_collective_tools=True
)
```

### –ü—Ä–æ–±–ª–µ–º–∞: –î–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ agent_type —É–∫–∞–∑–∞–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ –µ—Å—Ç—å –≤ AGENT_COMPETENCIES

```python
from agents.common.collective_work_tools import AGENT_COMPETENCIES

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–∞—à agent_type
print(list(AGENT_COMPETENCIES.keys()))
```

### –ü—Ä–æ–±–ª–µ–º–∞: Git –∫–æ–º–º–∏—Ç—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `run_with_integrations` –∏–ª–∏ –≤—ã–∑—ã–≤–∞–π—Ç–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —à–∞–≥–∏ –≤—Ä—É—á–Ω—É—é

```python
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–±
result = await run_with_integrations(...)

# –ò–ª–∏ —Ä—É—á–Ω–æ–π
await execute_mandatory_final_steps(...)
```

### –ü—Ä–æ–±–ª–µ–º–∞: Archon –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:** –ü–µ—Ä–µ–¥–∞–π—Ç–µ task_id –≤ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —à–∞–≥–∏

```python
await execute_mandatory_final_steps(
    task_description="...",
    agent_type="...",
    task_id="your_archon_task_id"  # –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û
)
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∫–æ–ª–ª–µ–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:
- üìã –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –º–∏–∫—Ä–æ–∑–∞–¥–∞—á–∏
- üìä –ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ü§ù –ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–µ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ–∂–¥—É –∞–≥–µ–Ω—Ç–∞–º–∏
- üîç –û–±—è–∑–∞—Ç–µ–ª—å–Ω—É—é —Ä–µ—Ñ–ª–µ–∫—Å–∏—é –∏ —É–ª—É—á—à–µ–Ω–∏–µ
- üéØ –°—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∏–Ω–∞–ª—å–Ω—ã–µ —à–∞–≥–∏ (Git + Archon)

–°–ª–µ–¥—É—è —ç—Ç–æ–º—É —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É, –≤—Å–µ –∞–≥–µ–Ω—Ç—ã –±—É–¥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≤ –µ–¥–∏–Ω–æ–º —Å—Ç–∏–ª–µ —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é.
