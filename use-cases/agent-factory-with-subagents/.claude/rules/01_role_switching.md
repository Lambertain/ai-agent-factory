# 01. Правила переключення в роль експерта

## ⚠️ КРИТИЧНО ВАЖЛИВО: ОБОВ'ЯЗКОВЕ ПЕРЕКЛЮЧЕННЯ В РОЛЬ

**🚨 ЖОДНА ЗАДАЧА НЕ ВИКОНУЄТЬСЯ БЕЗ ПЕРЕКЛЮЧЕННЯ В РОЛЬ!**

### 📋 Обов'язковий алгоритм ПЕРЕД будь-якою задачею:

```
ЕТАП 1: ПОШУК І ЧИТАННЯ ПРОМПТУ (1-2 хвилини)
├─ 1️⃣ Визначити роль з контексту задачі
├─ 2️⃣ Знайти промпт: Glob(**/*[ключове_слово]*knowledge*.md)
├─ 3️⃣ Прочитати системний промпт ролі
└─ 4️⃣ Вилучити ключові компетенції

ЕТАП 2: ОГОЛОШЕННЯ ПЕРЕКЛЮЧЕННЯ (ОБОВ'ЯЗКОВО ПОКАЗАТИ КОРИСТУВАЧУ)
├─ 🎭 "ПЕРЕКЛЮЧАЮСЯ В РОЛЬ [ІМ'Я РОЛІ]"
├─ 📋 "Моя експертиза:" + список з промпту
├─ ✅ "Готовий виконати задачу як [роль]"
└─ 🚨 Це повідомлення ПОВИННО бути видно користувачу

ЕТАП 3: СТВОРЕННЯ МІКРОЗАДАЧ (ОБОВ'ЯЗКОВО ПІСЛЯ ПЕРЕКЛЮЧЕННЯ)
├─ 🚨 НЕГАЙНО після оголошення переключення
├─ 📋 **ВИКОРИСТАТИ TodoWrite TOOL** з 3-7 мікрозадачами
├─ 🔴 **КРИТИЧНО**: Це має бути **Claude Code TodoWrite TOOL**, який **ВИДИМИЙ КОРИСТУВАЧУ В ЧАТІ**
├─ ✅ Кожна мікрозадача 5-15 хвилин
├─ 📌 Обов'язкові останні 2 пункти:
│   ├─ N-1: Рефлексія та критичний аналіз
│   └─ N: Git коміт з описом
├─ ⚠️ **НЕ ВИКОРИСТОВУВАТИ** кастомні функції `break_down_to_microtasks()`
└─ 🔴 ЗАБОРОНЕНО починати без TodoWrite TOOL видимого користувачу!

ЕТАП 4: ВИКОНАННЯ В РОЛІ
└─ Робота з контекстом експерта
```

### ❌ ПОРУШЕННЯ = НЕГАЙНА ЗУПИНКА:

- Якщо пропустив оголошення → ЗУПИНИ та оголоси
- Якщо працюєш як Claude Code → ЗУПИНИ та переключись
- Якщо немає мікрозадач → ЗУПИНИ та створи

### 📋 Обов'язковий шаблон переключення:

```
🔍 Шукаю промпт ролі [Назва ролі]...
📁 Знайдений файл: [шлях до файлу]
📖 Читаю системний промпт ролі...

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎭 ПЕРЕКЛЮЧАЮСЯ В РОЛЬ [НАЗВА РОЛІ]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 Моя експертиза:
• [ключова компетенція 1 з промпту]
• [ключова компетенція 2 з промпту]
• [ключова компетенція 3 з промпту]
• [технології та інструменти]

🎯 Спеціалізація:
• [область спеціалізації 1]
• [область спеціалізації 2]

✅ Готовий виконати задачу в ролі експерта [НАЗВА РОЛІ]

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

### ОБОВ'ЯЗКОВА ПОСЛІДОВНІСТЬ (СТРОГО):

```
┌─────────────────────────────────────────────┐
│ КРОК 1: ПЕРЕКЛЮЧЕННЯ (ПОКАЗАТИ КОРИСТУВАЧУ)│
│ ↓ Вивести шаблон вище                       │
└─────────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────────┐
│ КРОК 2: МІКРОЗАДАЧІ (TodoWrite TOOL)        │
│ ↓ НЕГАЙНО викликати TodoWrite TOOL          │
│ ↓ ВИДИМИЙ користувачу в чаті                │
│ ↓ 3-7 мікрозадач зі статусами               │
└─────────────────────────────────────────────┘
              ↓
┌─────────────────────────────────────────────┐
│ КРОК 3: ВИКОНАННЯ (В РОЛІ)                  │
│ ↓ Працювати з контекстом експерта           │
└─────────────────────────────────────────────┘
```

### 🚨 КРИТИЧНІ ПРАВИЛА:

1. **ЖОДНА ЗАДАЧА НЕ ПОЧИНАЄТЬСЯ БЕЗ ПЕРЕКЛЮЧЕННЯ**
2. **ПЕРЕКЛЮЧЕННЯ ЗАВЖДИ ВИДИМЕ КОРИСТУВАЧУ**
3. **ПІСЛЯ ПЕРЕКЛЮЧЕННЯ → ОДРАЗУ TodoWrite TOOL (ВИДИМИЙ КОРИСТУВАЧУ)**
4. **ЖОДНИХ ВИКЛЮЧЕНЬ ДЛЯ "ПРОСТИХ" ЗАДАЧ**
5. **🚨 КАТЕГОРИЧНО ЗАБОРОНЕНО використовувати кастомні функції замість TodoWrite TOOL**

### 📂 Алгоритм пошуку промптів ролей:

1. **Вилучити ключове слово з назви ролі:**
   - "UIUX Enhancement Agent" → "uiux"
   - "Prisma Database Agent" → "prisma"
   - "Payment Integration Agent" → "payment"

2. **Знайти файл знань:**
   ```
   Glob(path="D:\Automation\agent-factory\use-cases\agent-factory-with-subagents\agents",
        pattern="**/*[ключове_слово]*knowledge*.md")
   ```

3. **Прочитати файл і знайти системний промпт:**
   - Шукати розділ "Системний промпт" або "## Системний промпт"
   - Використати вміст для переключення в роль

4. **Якщо файл не знайдено:**
   ```
   Повідомити користувачу:
   "❌ Не знайдено файл знань для ролі '[Назва ролі]'
   📁 Очікуване розташування: D:\Automation\agent-factory\...\agents\[ім'я_агента]\knowledge\
   💡 Створіть файл знань із системним промптом для даної ролі"
   ```
