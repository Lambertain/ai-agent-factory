# 09. –ü—Ä–æ—Ç–æ–∫–æ–ª –∞–Ω–∞–ª—ñ–∑—É –ø—Ä–æ–±–ª–µ–º

## üö® –ö–†–ê–°–ù–ê –õ–Ü–ù–Ü–Ø: –ù–Ü –û–î–ù–û–ì–û –†–Ü–®–ï–ù–ù–Ø –ë–ï–ó –ê–ù–ê–õ–Ü–ó–£ –ö–û–ù–¢–ï–ö–°–¢–£

**–ü—Ä–æ–±–ª–µ–º–∞:** –ê–≥–µ–Ω—Ç–∏ –ø—Ä–æ–ø–æ–Ω—É—é—Ç—å —Ä—ñ—à–µ–Ω–Ω—è "–Ω–∞—É–≥–∞–¥" –±–µ–∑ –∞–Ω–∞–ª—ñ–∑—É –∫–æ–Ω—Ç–µ–∫—Å—Ç—É, —Å—Ç–≤–æ—Ä—é—é—Ç—å –©–ï –ë–Ü–õ–¨–®–ï –ø–æ–º–∏–ª–æ–∫.

**–†—ñ—à–µ–Ω–Ω—è:** –û–±–æ–≤'—è–∑–∫–æ–≤–∏–π –ø—Ä–æ—Ç–æ–∫–æ–ª –∞–Ω–∞–ª—ñ–∑—É –ü–ï–†–ï–î –∫–æ–∂–Ω–∏–º —Ä—ñ—à–µ–Ω–Ω—è–º.

---

## üìã –û–ë–û–í'–Ø–ó–ö–û–í–ê –ü–û–°–õ–Ü–î–û–í–ù–Ü–°–¢–¨ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

```
–ï–¢–ê–ü 0: –û–¢–†–ò–ú–ê–ù–ù–Ø –ü–†–û–ë–õ–ï–ú–ò
‚îî‚îÄ –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –ø–æ–≤—ñ–¥–æ–º–ª—è—î –ø—Ä–æ –ø—Ä–æ–±–ª–µ–º—É/–ø–æ–º–∏–ª–∫—É

–ï–¢–ê–ü 1: –ê–ù–ê–õ–Ü–ó –ö–û–ù–¢–ï–ö–°–¢–£ (–û–ë–û–í'–Ø–ó–ö–û–í–û!)
‚îú‚îÄ git log --oneline -20 ‚Üí —â–æ —Ä–æ–±–∏–ª–æ—Å—å –Ω–µ—â–æ–¥–∞–≤–Ω–æ
‚îú‚îÄ git log --grep="–∫–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞" ‚Üí —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ –∫–æ–º—ñ—Ç–∏
‚îú‚îÄ git show [commit] ‚Üí —â–æ —Å–∞–º–µ –∑–º—ñ–Ω–∏–ª–æ—Å—å
‚îú‚îÄ –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó/—Å—Ö–µ–º–∏/–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
‚îî‚îÄ –ü—Ä–æ—á–∏—Ç–∞—Ç–∏ –∑–º—ñ–Ω–µ–Ω—ñ —Ñ–∞–π–ª–∏

–ï–¢–ê–ü 2: –ó–Ü–°–¢–ê–í–õ–ï–ù–ù–Ø –ó –ü–û–ú–ò–õ–ö–û–Æ
‚îú‚îÄ –Ø–∫—ñ –∑–º—ñ–Ω–∏ –º–æ–≥–ª–∏ –≤–∏–∫–ª–∏–∫–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É
‚îú‚îÄ –©–æ –£–ñ–ï –∑—Ä–æ–±–ª–µ–Ω–æ (–Ω–µ –ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ!)
‚îî‚îÄ –Ø–∫—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –∑–∞—á–µ–ø–ª–µ–Ω—ñ

–ï–¢–ê–ü 3: –§–û–†–ú–£–í–ê–ù–ù–Ø –ì–Ü–ü–û–¢–ï–ó–ò
‚îú‚îÄ –ù–∞ –æ—Å–Ω–æ–≤—ñ –†–ï–ê–õ–¨–ù–ò–• –¥–∞–Ω–∏—Ö (–Ω–µ –∑–¥–æ–≥–∞–¥–æ–∫!)
‚îú‚îÄ –ó –≤–∫–∞–∑—É–≤–∞–Ω–Ω—è–º confidence level (LOW/MEDIUM/HIGH)
‚îî‚îÄ –ó –ø–æ—è—Å–Ω–µ–Ω–Ω—è–º –ß–û–ú–£ —Ç–∞–∫ –≤–≤–∞–∂–∞—î—à

–ï–¢–ê–ü 4: –¢–Ü–õ–¨–ö–ò –ü–û–¢–Ü–ú –†–Ü–®–ï–ù–ù–Ø
‚îî‚îÄ –ó–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è –∑ –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è–º
```

---

## üîç –§—É–Ω–∫—Ü—ñ—è analyze_problem_context

```python
from typing import Dict, List
from enum import Enum


class ConfidenceLevel(Enum):
    """–†—ñ–≤–µ–Ω—å –≤–ø–µ–≤–Ω–µ–Ω–æ—Å—Ç—ñ –≤ —Ä—ñ—à–µ–Ω–Ω—ñ."""
    LOW = "LOW"        # –ü–æ—Ç—Ä–µ–±—É—î –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
    MEDIUM = "MEDIUM"  # –ì—ñ–ø–æ—Ç–µ–∑–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—Ç–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
    HIGH = "HIGH"      # –¢–æ—á–Ω–æ –≤–∏–∑–Ω–∞—á–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∑ –¥–æ–∫–∞–∑–∞–º–∏


async def analyze_problem_context(
    problem_description: str,
    project_id: str
) -> Dict:
    """
    –û–ë–û–í'–Ø–ó–ö–û–í–ò–ô –ø—Ä–æ—Ç–æ–∫–æ–ª –∞–Ω–∞–ª—ñ–∑—É –ø—Ä–æ–±–ª–µ–º–∏ –ü–ï–†–ï–î —Ä—ñ—à–µ–Ω–Ω—è–º.

    ‚ö†Ô∏è –ó–ê–ë–û–†–û–ù–ï–ù–û –ø—Ä–æ–ø–æ–Ω—É–≤–∞—Ç–∏ —Ä—ñ—à–µ–Ω–Ω—è –ë–ï–ó —Ü—å–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É!

    Args:
        problem_description: –û–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        project_id: ID –ø—Ä–æ–µ–∫—Ç—É –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç—É

    Returns:
        Dict –∑ –∞–Ω–∞–ª—ñ–∑–æ–º: commits, changes, root_cause, solution, confidence

    Example:
        >>> result = await analyze_problem_context(
        ...     "ERROR: relation users does not exist",
        ...     "c75ef8e3-6f4d-4da2-9e81-8d38d04a341a"
        ... )
        >>> print(result['confidence'])
        ConfidenceLevel.HIGH
        >>> print(result['solution'])
        '–í–∏–ø—Ä–∞–≤–∏—Ç–∏ raw SQL –∑–∞–ø–∏—Ç –Ω–∞ Prisma query –≤ invites.service.ts:12'
    """

    print("üîç –®–ê–ì 1: –ß–ò–¢–ê–Æ –û–°–¢–ê–ù–ù–Ü –ö–û–ú–Ü–¢–ò")
    print("=" * 60)

    # 1. –ü—Ä–æ—á–∏—Ç–∞—Ç–∏ –æ—Å—Ç–∞–Ω–Ω—ñ 20 –∫–æ–º—ñ—Ç—ñ–≤
    commits_output = await bash("git log --oneline -20")
    print(f"–û—Å—Ç–∞–Ω–Ω—ñ –∫–æ–º—ñ—Ç–∏:\n{commits_output}\n")

    # 2. –ó–Ω–∞–π—Ç–∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ –∫–æ–º—ñ—Ç–∏ (–∫–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ –∑ –ø—Ä–æ–±–ª–µ–º–∏)
    keywords = extract_keywords(problem_description)
    print(f"–ö–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞: {', '.join(keywords)}")

    relevant_commits = []
    for keyword in keywords:
        grep_result = await bash(
            f"git log --grep='{keyword}' --oneline -20"
        )
        if grep_result:
            relevant_commits.extend(grep_result.split('\n'))

    relevant_commits = list(set(relevant_commits))  # –£–Ω—ñ–∫–∞–ª—å–Ω—ñ
    print(f"–ó–Ω–∞–π–¥–µ–Ω–æ {len(relevant_commits)} —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö –∫–æ–º—ñ—Ç—ñ–≤")

    print("\nüîç –®–ê–ì 2: –ê–ù–ê–õ–Ü–ó–£–Æ –†–ï–õ–ï–í–ê–ù–¢–ù–Ü –ó–ú–Ü–ù–ò")
    print("=" * 60)

    # 3. –ü–æ–¥–∏–≤–∏—Ç–∏—Å—å diff –æ—Å—Ç–∞–Ω–Ω—ñ—Ö —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö –∫–æ–º—ñ—Ç—ñ–≤
    changes_analysis = []
    for commit_line in relevant_commits[:5]:  # –ü–µ—Ä—à—ñ 5
        commit_hash = commit_line.split()[0]
        diff = await bash(f"git show {commit_hash}")

        print(f"\n–ö–æ–º—ñ—Ç {commit_hash}:")
        print(diff[:500] + "...\n")  # –ü–µ—Ä—à—ñ 500 —Å–∏–º–≤–æ–ª—ñ–≤

        changes_analysis.append({
            "commit": commit_hash,
            "diff": diff
        })

    print("\nüîç –®–ê–ì 3: –ü–ï–†–ï–í–Ü–†–Ø–Æ –©–û –£–ñ–ï –ó–†–û–ë–õ–ï–ù–û")
    print("=" * 60)

    # 4. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó
    try:
        migrations = await bash("ls -la prisma/migrations/")
        print(f"–ú—ñ–≥—Ä–∞—Ü—ñ—ó:\n{migrations}\n")
    except:
        print("–ú—ñ–≥—Ä–∞—Ü—ñ—ó –Ω–µ –∑–Ω–∞–π–¥–µ–Ω—ñ –∞–±–æ –Ω–µ –∑–∞—Å—Ç–æ—Å–æ–≤—É—é—Ç—å—Å—è\n")
        migrations = None

    # 5. –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —Å—Ö–µ–º—É –ë–î
    try:
        schema = await read_file("prisma/schema.prisma")
        print(f"–°—Ö–µ–º–∞ –ë–î (–ø–µ—Ä—à—ñ 500 —Å–∏–º–≤–æ–ª—ñ–≤):\n{schema[:500]}...\n")
    except:
        print("–°—Ö–µ–º–∞ –ë–î –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞\n")
        schema = None

    print("\nüîç –®–ê–ì 4: –ê–ù–ê–õ–Ü–ó–£–Æ –õ–û–ì–ò –ü–û–ú–ò–õ–ö–ò")
    print("=" * 60)

    # 6. –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É –∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º –∑–º—ñ–Ω
    error_analysis = analyze_error_with_context(
        error_logs=problem_description,
        recent_changes=changes_analysis,
        db_schema=schema,
        migrations=migrations
    )

    print("\n‚úÖ –®–ê–ì 5: –§–û–†–ú–£–Æ –û–°–ú–ò–°–õ–ï–ù–ï –†–Ü–®–ï–ù–ù–Ø")
    print("=" * 60)
    print(f"–ö–æ—Ä—ñ–Ω–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞: {error_analysis['root_cause']}")
    print(f"–†—ñ—à–µ–Ω–Ω—è: {error_analysis['solution']}")
    print(f"–í–ø–µ–≤–Ω–µ–Ω—ñ—Å—Ç—å: {error_analysis['confidence'].value}")

    return {
        "commits_analyzed": len(relevant_commits),
        "changes_found": changes_analysis,
        "root_cause": error_analysis["root_cause"],
        "solution": error_analysis["solution"],
        "confidence": error_analysis["confidence"]
    }


def extract_keywords(text: str) -> List[str]:
    """
    –í–∏–ª—É—á–∏—Ç–∏ –∫–ª—é—á–æ–≤—ñ —Å–ª–æ–≤–∞ –∑ –æ–ø–∏—Å—É –ø—Ä–æ–±–ª–µ–º–∏.

    Args:
        text: –û–ø–∏—Å –ø—Ä–æ–±–ª–µ–º–∏

    Returns:
        List —Ç–æ–ø-5 –∫–ª—é—á–æ–≤–∏—Ö —Å–ª—ñ–≤

    Example:
        >>> extract_keywords("ERROR: relation public.users does not exist")
        ['error', 'relation', 'users', 'exist']
    """

    # –í–∏–¥–∞–ª–∏—Ç–∏ —Å—Ç–æ–ø-—Å–ª–æ–≤–∞
    stop_words = {"the", "a", "an", "and", "or", "but", "in", "on", "at"}

    words = text.lower().split()
    keywords = [w for w in words if w not in stop_words and len(w) > 3]

    return keywords[:5]  # –¢–æ–ø-5


def analyze_error_with_context(
    error_logs: str,
    recent_changes: List[Dict],
    db_schema: str,
    migrations: str
) -> Dict:
    """
    –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞—Ç–∏ –ø–æ–º–∏–ª–∫—É –∑ —É—Ä–∞—Ö—É–≤–∞–Ω–Ω—è–º –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –∑–º—ñ–Ω.

    Args:
        error_logs: –õ–æ–≥–∏ –ø–æ–º–∏–ª–∫–∏
        recent_changes: –°–ø–∏—Å–æ–∫ –æ—Å—Ç–∞–Ω–Ω—ñ—Ö –∑–º—ñ–Ω (–∫–æ–º—ñ—Ç–∏ + diff)
        db_schema: –í–º—ñ—Å—Ç schema.prisma
        migrations: –í–º—ñ—Å—Ç –ø–∞–ø–∫–∏ –º—ñ–≥—Ä–∞—Ü—ñ–π

    Returns:
        Dict: {
            "root_cause": str,
            "solution": str,
            "confidence": ConfidenceLevel
        }

    Example:
        >>> result = analyze_error_with_context(
        ...     "relation public.users does not exist",
        ...     [{"commit": "abc123", "diff": "SELECT * FROM public.users"}],
        ...     "model User { ... }",
        ...     "20250109_create_users"
        ... )
        >>> result['confidence']
        ConfidenceLevel.HIGH
    """

    # –ü—Ä–∏–∫–ª–∞–¥ –ª–æ–≥—ñ–∫–∏ –∞–Ω–∞–ª—ñ–∑—É: –ø–æ–º–∏–ª–∫–∞ –∑ –ë–î
    if "relation" in error_logs and "does not exist" in error_logs:
        # –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ —á–∏ —Ç–∞–±–ª–∏—Ü—è —î –≤ —Å—Ö–µ–º—ñ
        table_name = extract_table_name(error_logs)

        if db_schema and table_name.lower() in db_schema.lower():
            # –¢–∞–±–ª–∏—Ü—è –Ñ –≤ —Å—Ö–µ–º—ñ - –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∑–∞–ø–∏—Ç—ñ
            return {
                "root_cause": f"–¢–∞–±–ª–∏—Ü—è {table_name} —ñ—Å–Ω—É—î –≤ schema.prisma, "
                             f"–∞–ª–µ –∑–∞–ø–∏—Ç –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å",
                "solution": "–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ raw SQL –∑–∞–ø–∏—Ç–∏ - –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ Prisma query",
                "confidence": ConfidenceLevel.HIGH
            }
        else:
            # –¢–∞–±–ª–∏—Ü—ñ –ù–ï–ú–ê–Ñ - –ø—Ä–æ–±–ª–µ–º–∞ –∑ –º—ñ–≥—Ä–∞—Ü—ñ—î—é
            return {
                "root_cause": f"–¢–∞–±–ª–∏—Ü—è {table_name} –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞ –≤ schema.prisma",
                "solution": "–î–æ–¥–∞—Ç–∏ model –¥–æ schema.prisma —Ç–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—é",
                "confidence": ConfidenceLevel.MEDIUM
            }

    # –ó–∞–≥–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ –¥–ª—è —ñ–Ω—à–∏—Ö —Ç–∏–ø—ñ–≤ –ø–æ–º–∏–ª–æ–∫
    return {
        "root_cause": "–ü–æ—Ç—Ä–µ–±—É—î –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É –ª–æ–≥—ñ–≤",
        "solution": "–î–æ–¥–∞—Ç–∫–æ–≤–∞ –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∞",
        "confidence": ConfidenceLevel.LOW
    }


def extract_table_name(error_text: str) -> str:
    """
    –í–∏–ª—É—á–∏—Ç–∏ –Ω–∞–∑–≤—É —Ç–∞–±–ª–∏—Ü—ñ –∑ –ø–æ–º–∏–ª–∫–∏.

    Args:
        error_text: –¢–µ–∫—Å—Ç –ø–æ–º–∏–ª–∫–∏

    Returns:
        –ù–∞–∑–≤–∞ —Ç–∞–±–ª–∏—Ü—ñ –∞–±–æ "unknown"

    Example:
        >>> extract_table_name('relation "public.users" does not exist')
        'public.users'
    """
    import re
    match = re.search(r'relation "([^"]+)"', error_text)
    return match.group(1) if match else "unknown"
```

---

## ‚ùå –ó–ê–ë–û–†–û–ù–ï–ù–Ü –§–†–ê–ó–ò (–≥–æ–≤–æ—Ä—è—Ç—å –ø—Ä–æ –∑–¥–æ–≥–∞–¥–∫–∏)

**–ù–Ü –ö–û–õ–ò –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:**

- "–í–µ—Ä–æ—è—Ç–Ω–æ —Ç–∞–±–ª–∏—Ü—è –Ω–µ —ñ—Å–Ω—É—î"
- "–°—Ö–æ–∂–µ –º—ñ–≥—Ä–∞—Ü—ñ—è –Ω–µ –∑–∞—Å—Ç–æ—Å—É–≤–∞–ª–∞—Å—å"
- "–ú–æ–∂–ª–∏–≤–æ —Å—Ö–µ–º–∞ –Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–∞"
- "–°–∫–æ—Ä—ñ—à–µ –∑–∞ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º–∞ –≤..."
- "–ù–∞–ø–µ–≤–Ω–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ..."
- "–ó–¥–∞—î—Ç—å—Å—è —â–æ..."

**–ß–æ–º—É –∑–∞–±–æ—Ä–æ–Ω–µ–Ω–æ:**
- –¶—ñ —Ñ—Ä–∞–∑–∏ –≥–æ–≤–æ—Ä—è—Ç—å —â–æ –∞–≥–µ–Ω—Ç –ù–ï –ê–ù–ê–õ–Ü–ó–£–í–ê–í –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –†—ñ—à–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∑–¥–æ–≥–∞–¥–æ–∫ —Å—Ç–≤–æ—Ä—é—é—Ç—å –©–ï –ë–Ü–õ–¨–®–ï –ø—Ä–æ–±–ª–µ–º
- –î–æ–≤–µ–¥–µ—Ç—å—Å—è –≤–∏–ø—Ä–∞–≤–ª—è—Ç–∏ —É 2 —Ä–∞–∑–∏ –±—ñ–ª—å—à–µ

---

## ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–Ü –§–†–ê–ó–ò (–≥–æ–≤–æ—Ä—è—Ç—å –ø—Ä–æ –∞–Ω–∞–ª—ñ–∑)

**–ó–ê–í–ñ–î–ò –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:**

- "–ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞–≤ –∫–æ–º—ñ—Ç X, –¥–µ –¥–æ–¥–∞–ª–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª Y"
- "–í diff –±–∞—á—É —â–æ –∑–º—ñ–Ω–∏–ª–∏ –∑–∞–ø–∏—Ç Z"
- "–ú—ñ–≥—Ä–∞—Ü—ñ—è –≤–∂–µ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–∞ (–¥–∏–≤. –∫–æ–º—ñ—Ç ABC)"
- "–°—Ö–µ–º–∞ –º—ñ—Å—Ç–∏—Ç—å —Ç–∞–±–ª–∏—Ü—é users (–ø–µ—Ä–µ–≤—ñ—Ä–∏–≤ schema.prisma)"
- "–†–µ–∞–ª—å–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Ä—è–¥–∫—É N —Ñ–∞–π–ª—É M (–¥–∏–≤. git show)"
- "–ù–∞ –æ—Å–Ω–æ–≤—ñ –∞–Ω–∞–ª—ñ–∑—É –∑–º—ñ–Ω —É –∫–æ–º—ñ—Ç—ñ X, –±–∞—á—É —â–æ..."
- "–ü–æ—Ä—ñ–≤–Ω—è–≤—à–∏ diff –∑ –ø–æ–º–∏–ª–∫–æ—é, –≤–∏–∑–Ω–∞—á–∏–≤ —â–æ..."

**–ß–æ–º—É –ø—Ä–∞–≤–∏–ª—å–Ω–æ:**
- –§—Ä–∞–∑–∏ –ø—ñ–¥–∫—Ä—ñ–ø–ª–µ–Ω—ñ –ö–û–ù–ö–†–ï–¢–ù–ò–ú–ò –¥–æ–∫–∞–∑–∞–º–∏
- –í–∫–∞–∑—É—é—Ç—å –Ω–∞ –¢–û–ß–ù–ï –º—ñ—Å—Ü–µ –ø—Ä–æ–±–ª–µ–º–∏
- –†—ñ—à–µ–Ω–Ω—è –±–∞–∑—É—î—Ç—å—Å—è –Ω–∞ –†–ï–ê–õ–¨–ù–ò–• –¥–∞–Ω–∏—Ö

---

## üìä –ü—Ä–∏–∫–ª–∞–¥ –ü–†–ê–í–ò–õ–¨–ù–û–ì–û –∞–Ω–∞–ª—ñ–∑—É

### –°–∏—Ç—É–∞—Ü—ñ—è:
```
–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á: "–ü–æ–º–∏–ª–∫–∞ –≤ production: ERROR: relation 'public.users' does not exist"
```

### ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–ê –≤—ñ–¥–ø–æ–≤—ñ–¥—å (–±–µ–∑ –∞–Ω–∞–ª—ñ–∑—É):
```
–ê–≥–µ–Ω—Ç: "–¢–∞–±–ª–∏—Ü—è users –Ω–µ —ñ—Å–Ω—É—î –≤ –ë–î.
–ü–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ Prisma –º—ñ–≥—Ä–∞—Ü—ñ—ó –Ω–∞ production."
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ê–≥–µ–Ω—Ç –ù–ï –ø–µ—Ä–µ–≤—ñ—Ä–∏–≤ —â–æ –º—ñ–≥—Ä–∞—Ü—ñ—è –≤–∂–µ –±—É–ª–∞!

### ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–ê –≤—ñ–¥–ø–æ–≤—ñ–¥—å (–∑ –∞–Ω–∞–ª—ñ–∑–æ–º):
```
–ê–≥–µ–Ω—Ç: "üîç –ê–Ω–∞–ª—ñ–∑—É—é –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø—Ä–æ–±–ª–µ–º–∏...

–®–ê–ì 1: –ß–∏—Ç–∞—é –æ—Å—Ç–∞–Ω–Ω—ñ –∫–æ–º—ñ—Ç–∏
- –ö–æ–º—ñ—Ç abc123: 'feat: add delete invite link feature'
- –ö–æ–º—ñ—Ç def456: 'fix: owner account missing'

–®–ê–ì 2: –ê–Ω–∞–ª—ñ–∑—É—é –∑–º—ñ–Ω–∏ –≤ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö –∫–æ–º—ñ—Ç–∞—Ö
git show abc123:
- –î–æ–¥–∞–Ω–æ –∑–∞–ø–∏—Ç: DELETE FROM invites WHERE...
- –ó–º—ñ–Ω–µ–Ω–æ –∑–∞–ø–∏—Ç: SELECT owner FROM accounts...
- –ó–ù–ê–ô–î–ï–ù–û raw SQL: SELECT * FROM public.users

–®–ê–ì 3: –ü–µ—Ä–µ–≤—ñ—Ä—è—é –º—ñ–≥—Ä–∞—Ü—ñ—ó —Ç–∞ —Å—Ö–µ–º—É
- –ú—ñ–≥—Ä–∞—Ü—ñ—è 20250109_create_users –£–ñ–ï –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–∞ ‚úÖ
- schema.prisma –ú–Ü–°–¢–ò–¢–¨ model User ‚úÖ
- Production –ë–î –º–∞—î —Ç–∞–±–ª–∏—Ü—é users ‚úÖ

–®–ê–ì 4: –í–∏—è–≤–ª–µ–Ω–Ω—è —Ä–µ–∞–ª—å–Ω–æ—ó –ø—Ä–æ–±–ª–µ–º–∏
–í –∫–æ–º—ñ—Ç—ñ abc123 –≤ —Ñ–∞–π–ª—ñ invites.service.ts:12
–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è RAW SQL –∑–∞–ø–∏—Ç:
  SELECT * FROM public.users

–ê–ª–µ –≤ Prisma –ø—Ä–æ–µ–∫—Ç—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏:
  prisma.user.findMany()

–®–ê–ì 5: –†—ñ—à–µ–Ω–Ω—è
–ö–û–†–Ü–ù–ù–ê –ü–†–ò–ß–ò–ù–ê: –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è raw SQL –∑–∞–º—ñ—Å—Ç—å Prisma query

–†–Ü–®–ï–ù–ù–Ø: –í–∏–ø—Ä–∞–≤–∏—Ç–∏ —Ä—è–¥–æ–∫ 12 —É invites.service.ts:
  // ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û:
  await prisma.$queryRaw`SELECT * FROM public.users`

  // ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
  await prisma.user.findMany()

CONFIDENCE: HIGH (–±–∞—á—É —Ç–æ—á–Ω–∏–π —Ä—è–¥–æ–∫ —É diff –∫–æ–º—ñ—Ç—É abc123)"
```

---

## üéØ Confidence Levels - –ö–æ–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏

### HIGH Confidence
**–ö–æ–ª–∏:** –¢–æ—á–Ω–æ –≤–∏–∑–Ω–∞—á–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–º–∏ –¥–æ–∫–∞–∑–∞–º–∏

**–ü—Ä–∏–∫–ª–∞–¥–∏:**
- –ó–Ω–∞–π—à–æ–≤ —Ç–æ—á–Ω–∏–π —Ä—è–¥–æ–∫ –∫–æ–¥—É –≤ diff
- –ë–∞—á—É –ø–æ–º–∏–ª–∫—É –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫–æ–º—ñ—Ç—ñ
- –ú—ñ–≥—Ä–∞—Ü—ñ—è –ø—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–∞, –∞–ª–µ –∑–∞–ø–∏—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π

**–§–æ—Ä–º–∞—Ç:**
```python
{
    "root_cause": "[–ö–æ–Ω–∫—Ä–µ—Ç–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞ –∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º –Ω–∞ –∫–æ–¥]",
    "solution": "[–¢–æ—á–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è –∑ –Ω–æ–º–µ—Ä–æ–º —Ä—è–¥–∫–∞]",
    "confidence": ConfidenceLevel.HIGH
}
```

### MEDIUM Confidence
**–ö–æ–ª–∏:** –ì—ñ–ø–æ—Ç–µ–∑–∞ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —á–∞—Å—Ç–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö

**–ü—Ä–∏–∫–ª–∞–¥–∏:**
- –ü—ñ–¥–æ–∑—Ä–∞ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—É –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –º–æ–¥—É–ª—ñ
- –Ñ –ø–∞—Ç–µ—Ä–Ω –ø–æ–º–∏–ª–æ–∫, –∞–ª–µ –Ω–µ —Ç–æ—á–Ω–∞ –ª–æ–∫–∞—Ü—ñ—è
- –ú—ñ–≥—Ä–∞—Ü—ñ—è –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–∞ (–º–æ–∂–ª–∏–≤–æ –Ω–µ –∑–∞—Å—Ç–æ—Å–æ–≤–∞–Ω–∞)

**–§–æ—Ä–º–∞—Ç:**
```python
{
    "root_cause": "[–ô–º–æ–≤—ñ—Ä–Ω–∞ –ø—Ä–∏—á–∏–Ω–∞ –∑ –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è–º]",
    "solution": "[–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–µ —Ä—ñ—à–µ–Ω–Ω—è + —â–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏]",
    "confidence": ConfidenceLevel.MEDIUM
}
```

### LOW Confidence
**–ö–æ–ª–∏:** –ü–æ—Ç—Ä–µ–±—É—î –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

**–ü—Ä–∏–∫–ª–∞–¥–∏:**
- –ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –≤ –ª–æ–≥–∞—Ö
- –ù–µ –∑–Ω–∞–π–¥–µ–Ω–æ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–∏—Ö –∫–æ–º—ñ—Ç—ñ–≤
- –ü—Ä–æ–±–ª–µ–º–∞ –º–æ–∂–µ –±—É—Ç–∏ –≤ –∫—ñ–ª—å–∫–æ—Ö –º—ñ—Å—Ü—è—Ö

**–§–æ—Ä–º–∞—Ç:**
```python
{
    "root_cause": "–ü–æ—Ç—Ä–µ–±—É—î –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –∞–Ω–∞–ª—ñ–∑—É",
    "solution": "[–©–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∫–æ–≤–æ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏]",
    "confidence": ConfidenceLevel.LOW
}
```

---

## üö® –ö–†–ò–¢–ò–ß–ù–ï –ü–†–ê–í–ò–õ–û

**–ù–Ü –û–î–ù–û–ì–û —Ä—ñ—à–µ–Ω–Ω—è –±–µ–∑ analyze_problem_context()!**

```python
# ‚ùå –ó–ê–ë–û–†–û–ù–ï–ù–û - —Ä—ñ—à–µ–Ω–Ω—è –±–µ–∑ –∞–Ω–∞–ª—ñ–∑—É
async def fix_problem(error_description: str):
    # –ê–≥–µ–Ω—Ç –æ–¥—Ä–∞–∑—É –ø—Ä–æ–ø–æ–Ω—É—î —Ä—ñ—à–µ–Ω–Ω—è
    return "–ü–æ—Ç—Ä—ñ–±–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó"


# ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û - —Å–ø–æ—á–∞—Ç–∫—É –∞–Ω–∞–ª—ñ–∑
async def fix_problem(error_description: str, project_id: str):
    # –û–ë–û–í'–Ø–ó–ö–û–í–û: —Å–ø–æ—á–∞—Ç–∫—É –∞–Ω–∞–ª—ñ–∑
    analysis = await analyze_problem_context(
        problem_description=error_description,
        project_id=project_id
    )

    # –¢–Ü–õ–¨–ö–ò –ü–û–¢–Ü–ú —Ä—ñ—à–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ –∞–Ω–∞–ª—ñ–∑—É
    if analysis['confidence'] == ConfidenceLevel.HIGH:
        return analysis['solution']
    else:
        return f"–ü–æ—Ç—Ä–µ–±—É—î –¥–æ–¥–∞—Ç–∫–æ–≤–æ—ó –¥—ñ–∞–≥–Ω–æ—Å—Ç–∏–∫–∏: {analysis['root_cause']}"
```

---

## üìù –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –∞–≥–µ–Ω—Ç—ñ–≤

–ü—Ä–∏ –æ—Ç—Ä–∏–º–∞–Ω–Ω—ñ –ø—Ä–æ–±–ª–µ–º–∏ –≤—ñ–¥ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:

- [ ] –ü—Ä–æ—á–∏—Ç–∞–≤ git log --oneline -20
- [ ] –ó–Ω–∞–π—à–æ–≤ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ –∫–æ–º—ñ—Ç–∏ –∑–∞ –∫–ª—é—á–æ–≤–∏–º–∏ —Å–ª–æ–≤–∞–º–∏
- [ ] –ü—Ä–æ–∞–Ω–∞–ª—ñ–∑—É–≤–∞–≤ diff –∑–º—ñ–Ω–µ–Ω–∏—Ö —Ñ–∞–π–ª—ñ–≤
- [ ] –ü–µ—Ä–µ–≤—ñ—Ä–∏–≤ –º—ñ–≥—Ä–∞—Ü—ñ—ó/—Å—Ö–µ–º—É/–∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
- [ ] –ó—ñ—Å—Ç–∞–≤–∏–≤ –∑–º—ñ–Ω–∏ –∑ –ø–æ–º–∏–ª–∫–æ—é
- [ ] –°—Ñ–æ—Ä–º—É–≤–∞–≤ –≥—ñ–ø–æ—Ç–µ–∑—É –∑ confidence level
- [ ] –ü–æ—è—Å–Ω–∏–≤ –ß–û–ú–£ —Ç–∞–∫ –≤–≤–∞–∂–∞—é (–∑ –¥–æ–∫–∞–∑–∞–º–∏)
- [ ] –ó–∞–ø—Ä–æ–ø–æ–Ω—É–≤–∞–≤ —Ä—ñ—à–µ–Ω–Ω—è –∑ –æ–±“ë—Ä—É–Ω—Ç—É–≤–∞–Ω–Ω—è–º

**–Ø–∫—â–æ —Ö–æ—á–∞ –± 1 –ø—É–Ω–∫—Ç –ù–ï –≤–∏–∫–æ–Ω–∞–Ω–∏–π ‚Üí —Ä—ñ—à–µ–Ω–Ω—è –ù–ï –î–ê–í–ê–¢–ò!**

---

**–í–µ—Ä—Å—ñ—è:** 1.0
**–î–∞—Ç–∞:** 2025-10-09
**–ê–≤—Ç–æ—Ä:** Archon Blueprint Architect
